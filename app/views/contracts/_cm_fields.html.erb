<tr class="nested-fields line-item">
  <td>
    <%= link_to_remove_association f, {class: 'btn btn-small btn-default'} do %>
      <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
    <% end %>
  </td>
  <td>
    <p class="form-control-static">
      <%= f.object.new_record? ? "new" : f.index + 1 %>
    </p>
  </td>
  <%= f.fields_for :machine, f.object.machine || f.object.build_machine do |mf| %>
    <td>
      <%= mf.input :name, label: false %>
    </td>
    <td>
      <%= mf.input :mac, label: false %>
    </td>
    <td>
      <%= mf.input :cpu, label: false %>
    </td>
    <td>
      <%= mf.input :ram, label: false %>
    </td>
    <td>
      <%= mf.input :hdd, label: false %>
    </td>
    <td>
      <%= mf.input :optical_drive, label: false %>
    </td>
    <td>
      <%= mf.input :os, label: false %>
    </td>
    <td>
      <%= mf.input :purchase_date, as: :string, input_html: {class: 'datepicker'}, label: false %>
    </td>
  <% end %>
</tr>